stages:
  - build
  - publish

gradle-build:
  stage: build
  rules:
    - if: $CI_COMMIT_TAG == null
  image: ${CI_DEPENDENCY_PROXY_GROUP_IMAGE_PREFIX}/gradle:7-jdk17
  script: gradle build

nexus-deploy:
  stage: publish
  rules:
    - if: $CI_COMMIT_TAG
  image: ${CI_DEPENDENCY_PROXY_GROUP_IMAGE_PREFIX}/gradle:7-jdk17
  script: gradle -PsnapshotRepo="$NEXUS_SNAPSHOTS" -PreleaseRepo="$NEXUS_RELEASES" -PdeployUser="$NEXUS_DEPLOY_USER" -PdeployPassword="$NEXUS_DEPLOY_PASSWORD" publish
